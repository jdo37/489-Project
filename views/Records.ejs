<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" href="/css/style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.0/dist/chart.min.js"></script>
</head>
<body>
  <%- include('nav') -%>
  <main style="margin-top:8%">
    <H1>Records</H1>
    <hr>
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Question</th>
          <th>Answers</th>
          <th>Vote Counts</th>
          <th>Vote Count Chart</th>
        </tr>
      </thead>
      <tbody>
        <% questions.forEach(function(question) { %>
        <tr>
          <td><%= question.id %></td>
          <td><%= question.question %></td>
          <td>
            <button class="display-answer-btn" data-answer="<%= question.answers.join(', ') %>">view results</button>
          </td>
          <td><%= question.vote_counts.join(', ') %></td>
          <td>
            <div style="height: 100px; width: 300px; display: flex;">
              <% question.vote_counts.forEach(function(count) { %>
              <div style="background-color: blue; height: <%= count %>px; width: 50px; margin-right: 5px;"></div>
              <% }) %>
            </div>
          </td>
        </tr>
        <% }) %>
      </tbody>
    </table>
  </main>
  
    </div>
    <script>
      // Select all the display-answer-btn buttons
      const displayAnswerBtns = document.querySelectorAll(".display-answer-btn");
  
      // Add event listeners to each button
      displayAnswerBtns.forEach((btn) => {
        btn.addEventListener("click", () => {
          // Retrieve the answer from the data-answer attribute
          const answer = btn.getAttribute("data-answer");
  
          const answerEl = document.createElement("div");
          answerEl.innerHTML = `Answer: ${answer}`;
  
          // Append the answer element to the button's parent element
          btn.parentNode.appendChild(answerEl);
  
          // Hide the button after the answer is displayed
          btn.style.display = "none";
        });
      });
    </script>
    
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
      crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
      integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
      crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
      integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
      crossorigin="anonymous"></script>
</body>
</html>
